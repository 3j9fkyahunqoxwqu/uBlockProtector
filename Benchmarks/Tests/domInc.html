<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <!--<meta name="description" content="" />-->
    <meta name="author" content="jspenguin2017" />
    <!--<link rel="icon" href="" />-->
    <title>uBlock Protector Benchmarking Tool</title>
</head>
<body>
    <script>
        /**
         * Run a test and time it
         * @function
         * @param {Function} func - The function to run.
         * @param {string} name - The name of the test.
         * @param {Any} result - The expected result.
         */
        var run = (func, name, result) => {
            let finalTime = 0;
            for (let i = 0; i < 200; i++) {
                let res;
                const t0 = performance.now();
                res = func(list);
                const t1 = performance.now();
                if (res === result) {
                    finalTime += (t1 - t0);
                } else {
                    console.log(`${name} failed`);
                    return;
                }
            }
            console.log(`${name} used ${finalTime} milliseconds`);
        };

        const dom1 = "www.thenational.com"; //Test normal match
        const dom2 = "thenational.com"; //Test normal match

        let a = {};
        a.dom = dom1; //The one we are testing
        a.config = { debugMode: false };

        const list = ["360.cn", "apple.com", "ask.com", "baidu.com", "bing.com", "bufferapp.com",
            "chromeactions.com", "easyinplay.net", "ebay.com", "facebook.com", "flattr.com", "flickr.com",
            "ghacks.net", "imdb.com", "imgbox.com", "imgur.com", "instagram.com", "jsbin.com", "jsfiddle.net",
            "linkedin.com", "live.com", "mail.ru", "microsoft.com", "msn.com", "paypal.com", "pinterest.com",
            "preloaders.net", "qq.com", "reddit.com", "stackoverflow.com", "tampermonkey.net", "twitter.com",
            "vimeo.com", "wikipedia.org", "w3schools.com", "yandex.ru", "youtu.be", "youtube.com", "xemvtv.net",
            "vod.pl", "agar.io", "pandoon.info", "fsf.org", "adblockplus.org", "plnkr.co", "exacttarget.com",
            "dolldivine.com", "popmech.ru", "calm.com", "chatango.com", "filiser.tv", "sthelensstar.co.uk",
            "runcornandwidnesworld.co.uk", "leighjournal.co.uk",
            "warringtonguardian.co.uk", "northwichguardian.co.uk", "middlewichguardian.co.uk",
            "knutsfordguardian.co.uk", "wilmslowguardian.co.uk", "creweguardian.co.uk",
            "thewestmorlandgazette.co.uk", "newsquest.co.uk", "messengernewspapers.co.uk",
            "lancashiretelegraph.co.uk", "asianimage.co.uk", "chorleycitizen.co.uk",
            "theboltonnews.co.uk", "burytimes.co.uk", "prestwichandwhitefieldguide.co.uk",
            "wirralglobe.co.uk", "autoexchange.co.uk", "chesterlestreetadvertiser.co.uk",
            "consettstanleyadvertiser.co.uk", "darlingtonaycliffesedgefieldadvertiser.co.uk",
            "darlingtonandstocktontimes.co.uk", "durhamadvertiser.co.uk",
            "edition.pagesuite-professional.co.uk", "durhamtimes.co.uk", "northyorkshireadvertiser.co.uk",
            "thenorthernecho.co.uk", "northernfarmer.co.uk", "wearvalleyadvertiser.co.uk",
            "gazetteherald.co.uk", "yorkpress.co.uk", "cravenherald.co.uk", "ilkleygazette.co.uk",
            "keighleynews.co.uk", "thetelegraphandargus.co.uk", "wharfedaleobserver.co.uk",
            "herefordtimes.com", "ludlowadvertiser.co.uk", "redditchadvertiser.co.uk",
            "bromsgroveadvertiser.co.uk", "droitwichadvertiser.co.uk", "cotswoldjournal.co.uk",
            "eveshamjournal.co.uk", "tewkesburyadmag.co.uk", "dudleynews.co.uk", "halesowennews.co.uk",
            "stourbridgenews.co.uk", "kidderminstershuttle.co.uk", "ledburyreporter.co.uk",
            "malverngazette.co.uk", "worcesternews.co.uk", "southendstandard.co.uk",
            "essexcountystandard.co.uk", "gazette-news.co.uk", "clactonandfrintongazette.co.uk",
            "harwichandmanningtreestandard.co.uk", "braintreeandwithamtimes.co.uk", "halsteadgazette.co.uk",
            "guardian-series.co.uk", "brentwoodweeklynews.co.uk", "chelmsfordweeklynews.co.uk",
            "maldonandburnhamstandard.co.uk", "thurrockgazette.co.uk", "basildonrecorder.co.uk",
            "echo-news.co.uk", "bucksfreepress.co.uk", "theargus.co.uk", "redhillandreigatelife.co.uk",
            "romseyadvertiser.co.uk", "dailyecho.co.uk", "hampshirechronicle.co.uk",
            "basingstokegazette.co.uk", "andoveradvertiser.co.uk", "stalbansreview.co.uk",
            "watfordobserver.co.uk", "heraldseries.co.uk", "banburycake.co.uk", "bicesteradvertiser.net",
            "oxfordmail.co.uk", "oxfordtimes.co.uk", "witneygazette.co.uk", "falmouthpacket.co.uk",
            "smallholder.co.uk", "southwestfarmer.co.uk", "dorsetecho.co.uk", "bournmouthecho.co.uk",
            "bridportnews.co.uk", "wiltsglosstandard.co.uk", "gazetteseries.co.uk", "bridgwatermercury.co.uk",
            "burnhamandhighbridgeweeklynews.co.uk", "chardandilminsternews.co.uk", "middevonstar.co.uk",
            "somersetcountygazette.co.uk", "thisisthewestcountry.co.uk", "yeovilexpress.co.uk",
            "wiltshiretimes.co.uk", "swindonadvertiser.co.uk", "salisburyjournal.co.uk",
            "boxingnewsonline.net", "engagedinvestor.co.uk", "globalreinsurance.com", "insurancetimes.co.uk",
            "pensions-insight.co.uk", "strategic-risk-global.com", "reward-guide.co.uk", "thestrad.com",
            "times-series.co.uk", "borehamwoodtimes.co.uk", "ealingtimes.co.uk", "enfieldindependent.co.uk",
            "haringeyindependent.co.uk", "harrowtimes.co.uk", "hillingdontimes.co.uk", "newsshopper.co.uk",
            "croydonguardian.co.uk", "epsomguardian.co.uk", "streathamguardian.co.uk", "suttonguardian.co.uk",
            "wandsworthguardian.co.uk", "wimbledonguardian.co.uk", "surreycomet.co.uk", "kingstonguardian.co.uk",
            "richmondandtwickenhamtimes.co.uk", "campaignseries.co.uk", "southwalesguardian.co.uk",
            "milfordmercury.co.uk", "pembrokeshirecountyliving.co.uk", "westerntelegraph.co.uk",
            "tivysideadvertiser.co.uk", "southwalesargus.co.uk", "cotswoldessence.co.uk",
            "freepressseries.co.uk", "monmouthshirecountylife.co.uk", "barryanddistrictnews.co.uk",
            "penarthtimes.co.uk", "eveningtimes.co.uk", "s1cars.com", "s1community.com", "s1homes.com",
            "s1jobs.com", "s1rental.com", "thescottishfarmer.co.uk", "heraldscotland.com", "thenational"];

        //Algorithm 1
        var test1 = (domList, noErr) => {
            //Loop though each element
            for (let i = 0; i < domList.length; i++) {
                if (a.dom.startsWith(domList[i] + ".") || a.dom.includes("." + domList[i] + ".")) {
                    if (a.config.debugMode && !noErr) {
                        //Show error message when matched
                        a.err();
                    }
                    return true;
                }
            }
            return false;
        };
        //Algorithm 2
        var test2 = (domList, noErr) => {
            //Loop though each element
            let index;
            for (let i = 0; i < domList.length; i++) {
                index = a.dom.indexOf(domList[i] + ".");
                switch (index) {
                    case -1: continue;
                    case 0: return (a.config.debugMode && !noErr && a.err()), true;
                    default:
                        if (a.dom[index - 1] === ".") {
                            return (a.config.debugMode && !noErr && a.err()), true;
                        }
                        break;
                }
            }
            return false;
        };
    </script>
    <button onclick="run(test1, 'Algorithm 1', true);">Test 1</button>
    <button onclick="run(test2, 'Algorithm 2', true);">Test 2</button>
</body>
</html>
